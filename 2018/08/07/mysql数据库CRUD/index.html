<!DOCTYPE html>




<html class="theme-next " lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="//main.css?v=" rel="stylesheet" type="text/css" />









  <meta name="keywords" content="数据库," />










<meta name="description" content="mysql数据库CRUD  本文从基础开始介绍mysql数据库的增删改查等基础知识 下载安装mysql数据库启动服务 services.msg  管理——&amp;gt;服务——&amp;gt;启动mysql  cmd——&amp;gt;net start mysql  偏好设置——&amp;gt;run（Mac）   ####停止服务  net stop mysql net restart mysql(重启)注：以管理员身份运">
<meta name="keywords" content="数据库">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql数据库CRUD">
<meta property="og:url" content="http://yoursite.com/2018/08/07/mysql数据库CRUD/index.html">
<meta property="og:site_name" content="Karen">
<meta property="og:description" content="mysql数据库CRUD  本文从基础开始介绍mysql数据库的增删改查等基础知识 下载安装mysql数据库启动服务 services.msg  管理——&amp;gt;服务——&amp;gt;启动mysql  cmd——&amp;gt;net start mysql  偏好设置——&amp;gt;run（Mac）   ####停止服务  net stop mysql net restart mysql(重启)注：以管理员身份运">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/Users/lilamei/blog/hexo/source/_posts/数据分析————-2/ER图.png">
<meta property="og:image" content="http://yoursite.com/Users/lilamei/blog/hexo/source/_posts/mysql数据库CRUD/可视化建表.png">
<meta property="og:image" content="http://yoursite.com/Users/lilamei/blog/hexo/source/_posts/mysql数据库CRUD/可视化建立外键.png">
<meta property="og:image" content="http://yoursite.com/Users/lilamei/blog/hexo/source/_posts/mysql数据库CRUD/外键预览.png">
<meta property="og:updated_time" content="2018-08-30T13:16:34.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mysql数据库CRUD">
<meta name="twitter:description" content="mysql数据库CRUD  本文从基础开始介绍mysql数据库的增删改查等基础知识 下载安装mysql数据库启动服务 services.msg  管理——&amp;gt;服务——&amp;gt;启动mysql  cmd——&amp;gt;net start mysql  偏好设置——&amp;gt;run（Mac）   ####停止服务  net stop mysql net restart mysql(重启)注：以管理员身份运">
<meta name="twitter:image" content="http://yoursite.com/Users/lilamei/blog/hexo/source/_posts/数据分析————-2/ER图.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: '',
    version: '',
    sidebar: "",
    fancybox: ,
    tabs: ,
    motion: "",
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: "",
      labels: ""
    }
  };
</script>







  <title>mysql数据库CRUD | Karen</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  

  <div class="container  page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Karen</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/07/mysql数据库CRUD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="karen2066">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Karen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">mysql数据库CRUD</h1>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="mysql数据库CRUD"><a href="#mysql数据库CRUD" class="headerlink" title="mysql数据库CRUD"></a>mysql数据库CRUD</h3><p>  本文从基础开始介绍mysql数据库的增删改查等基础知识</p>
<h4 id="下载安装mysql数据库"><a href="#下载安装mysql数据库" class="headerlink" title="下载安装mysql数据库"></a>下载安装mysql数据库</h4><h4 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h4><ol>
<li><p>services.msg</p>
</li>
<li><p>管理——&gt;服务——&gt;启动mysql</p>
</li>
<li><p>cmd——&gt;net start mysql</p>
</li>
<li><p>偏好设置——&gt;run（Mac）</p>
</li>
</ol>
<p>####停止服务</p>
<ol>
<li>net stop mysql</li>
<li>net restart mysql(重启)<br>注：以管理员身份运行<br> 如果要卸载，需要用installer卸载，否则将会有残余以后无法再次下载使用mysql</li>
</ol>
<p>启动客户端工具：<br>    在安装社区版mysql后会自动帮我们安装一个mysql的客户端，进入的方式有两种：<br>    mysql -u root -p 进入本机数据库（注意配置路径）<br>    或者从开始菜单进入<br>showdatabases; 查看所有数据库（自带4个数据库，mysql程序相关的元数据信息，mysql自己要用的）<br>select version();查看目前使用的版本<br>? 获取帮助<br>quit/exit 退出</p>
<p>####SQL(Structured Query Language)<br>我们这里使用navicat for mysql可视化工具学习sql,sql语言是不区分大小写的</p>
<ul>
<li>DDL(数据定义语言): create/ drop/ alter</li>
<li>DML(数据操纵语言): insert/ delete/ update</li>
<li>DQL(数据查询语言): select</li>
<li>DCL(数据控制语言): grant/ revoke/ begin/ commit/ rollback</li>
</ul>
<p>####数据定义语言</p>
<p>#####如果指定的数据库存在则删除<br>    drop database if exists XXX;</p>
<p>#####创建数据库并指定默认字符集<br>    create database XXX default charset utf8;</p>
<p>#####切换到XXX数据库<br>    use XXX；</p>
<p>#####关系型数据库通过二维表来创建</p>
<p>######创建学生表,定义字段</p>
<p>######主键（primary key）-能够标识唯一一条记录的列<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_student</span><br><span class="line">(</span><br><span class="line">stuid <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'学号'</span>,</span><br><span class="line">sname <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'姓名'</span>,</span><br><span class="line">ssex <span class="built_in">bit</span> <span class="keyword">default</span> <span class="number">1</span>,</span><br><span class="line">stel <span class="built_in">char</span>(<span class="number">11</span>),</span><br><span class="line">sbirth <span class="built_in">date</span>,</span><br><span class="line">primary <span class="keyword">key</span>(stuid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>键的类型：int, varchar, bit……<br>非空约束：not null<br>默认值约束：default<br>备注：comment<br>指定字符集：charset utf8<br>指定排序规则：collation utf8_bin (如果没有指定会默认)<br>自增长的字段：int … auto_increment</p>
<blockquote>
<p>字段的三大类数据类型：<br>数值型（包括整数小数）<br>字符串<br>时间日期型</p>
</blockquote>
<p>为表指定存储引擎，指定字符集：<br>看到表的结构：desc tb_student</p>
<p>#####修改表<br>    插入新的字段<br>    alter table tb_student add columu asddr varchar(100);<br>    删除字段<br>    alter table tb_student drop columu stel;</p>
<p>#####插入记录<br>    一次插入一条学生纪录<br>    insert into tb_student values(1001, ‘小白’, 1, ‘1999-3-08’, ‘北京’);<br>    选择性插入学生纪录，指定顺序<br>    insert into tb_student (sname, stuid) values (‘小红’, 1002)<br>    批量插入学生纪录<br>    insert into tb_student values<br>    (1001, ‘小童’, 0, ‘1995-7-02’, ‘江苏南京’),<br>    (1002, ‘小灰灰’, 1, ‘1989-3-23’, ‘上海’),<br>    (1003, ‘小白’, 1, ‘1997-8-30’,’湖南长沙’),<br>    (1004, ‘小花’, 0, ‘1995-7-08’, ‘江苏南京’),<br>    (1005, ‘小江’, 1, ‘1989-3-23’, ‘上海’),<br>    (1006, ‘小飞’, 1, ‘1997-8-30’,’湖南长沙’);</p>
<p>#####删除数据<br>    删除全表(一般不会使用)<br>    delete from tb_student;<br>    删除某一条记录<br>    delete from tb_student where stuid=1003;</p>
<p>#####更新数据<br>    没有加条件，全表所有人的生日和住址都会被改变<br>    update tb_student set sbirth=’1999-2-03’, saddr=’四川成都’;<br>    更新某一条数据(通常情况下更新和删除单条数据都是以主键作为条件)<br>    update tb_student set sbirth=’1999-2-03’, saddr=’四川成都’ where stuid=1002;</p>
<p>在sql中一个=是相等的意思，如果想要赋值前面加set</p>
<p><strong>批量更新数据</strong></p>
<ul>
<li>使用or连接</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update tb_student set saddr=&apos;统一地址&apos; where stuid=1004 or stuid=1005 or stuid=1006;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用集合</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update tb_student set addr=&apos;统一地址&apos; where stuid in (1004, 1005, 1006);</span><br></pre></td></tr></table></figure>
<h4 id="例子1"><a href="#例子1" class="headerlink" title="例子1:"></a>例子1:</h4><h5 id="创建课程表和学生表"><a href="#创建课程表和学生表" class="headerlink" title="创建课程表和学生表"></a>创建课程表和学生表</h5><p>创建数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database student default charset utf8;</span><br></pre></td></tr></table></figure>
<p>创建课程表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table tb_course</span><br><span class="line">(</span><br><span class="line">courseid int not null,</span><br><span class="line">cname varchar(20) not null,</span><br><span class="line">ccredit int not null,</span><br><span class="line">primary key (courseid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>插入数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">insert into tb_course(courseid, cname, ccredit) values </span><br><span class="line">(001, &apos;python程序设计&apos;, 3),</span><br><span class="line">(002, &apos;java&apos;, 2),</span><br><span class="line">(003, &apos;linux操作系统&apos;, 1),</span><br><span class="line">(004, &apos;数据库基础&apos;, 1);</span><br></pre></td></tr></table></figure>
<p>记录学生选课记录，还需要一张学生选课记录表（中间表）</p>
<h4 id="分析学生表和课程表之间的关系，ER图（实体关系图）"><a href="#分析学生表和课程表之间的关系，ER图（实体关系图）" class="headerlink" title="分析学生表和课程表之间的关系，ER图（实体关系图）"></a>分析学生表和课程表之间的关系，ER图（实体关系图）</h4><p><img src="/Users/lilamei/blog/hexo/source/_posts/数据分析————-2/ER图.png" alt="ER图"></p>
<p>专业的数据库建模工具：PowerDesigner</p>
<h4 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h4><p>创建一对一的人员表和身份证表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_person</span><br><span class="line">(</span><br><span class="line">personid <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">pname <span class="built_in">varchar</span> (<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">pbirth <span class="built_in">date</span>,</span><br><span class="line">primary <span class="keyword">key</span> (personid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_idcard</span><br><span class="line">(</span><br><span class="line">cardid <span class="built_in">char</span>(<span class="number">18</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">cpolice <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">cexpire <span class="built_in">date</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">pid <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">primary <span class="keyword">key</span> (cardid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_idcard <span class="keyword">add</span> <span class="keyword">constraint</span> fk_idcard_pid foreign <span class="keyword">key</span> (pid) <span class="keyword">references</span> tb_person (personid);</span><br></pre></td></tr></table></figure>
<p>pid 只能参照人员表的主键personid，表示二者的一对一关系</p>
<p>fk_idcard_pid:表示foreignkey在idcard这张表中的pid字段</p>
<p>外键：一个外来的主键</p>
<h4 id="参照完整性"><a href="#参照完整性" class="headerlink" title="参照完整性"></a>参照完整性</h4><p>录入数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_person (pname, pbirth) <span class="keyword">values</span></span><br><span class="line">(<span class="string">'小飞飞'</span>, <span class="string">'1992-09-01'</span>),</span><br><span class="line">(<span class="string">'小可爱'</span>, <span class="string">'1992-10-01'</span>),</span><br><span class="line">(<span class="string">'小红花'</span>. <span class="string">'1982-09-01'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_idcard <span class="keyword">values</span></span><br><span class="line">(<span class="string">'847584848373728323'</span>, <span class="string">'成都市武侯区公安局'</span>,<span class="string">'2019-09-30'</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">'818181818282738374'</span>, <span class="string">'成都市金牛区公安局'</span>,<span class="string">'2022-09-30'</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">'818184848373827283'</span>, <span class="string">'成都市锦江区公安局'</span>,<span class="string">'2033-01-09'</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p>外键参照另一张表，有完整性约束，必须参照另一张表的主键，没有的主键也不能添加外键</p>
<h4 id="建立一对一的关联关系"><a href="#建立一对一的关联关系" class="headerlink" title="建立一对一的关联关系"></a>建立一对一的关联关系</h4><h4 id="唯一性约束"><a href="#唯一性约束" class="headerlink" title="唯一性约束"></a>唯一性约束</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_idcard <span class="keyword">add</span> <span class="keyword">constraint</span> uk_idcard_pid <span class="keyword">unique</span>(pid);</span><br></pre></td></tr></table></figure>
<p>外键对应的记录不能重复添加，且有且仅有关联到另一张表的另一个唯一的主键，一对一的关联关系完成</p>
<p><strong>如果没有唯一性约束就是一对多的关联关系了</strong></p>
<p>且建立外键关系后，如需删除被参照的记录，需要先删除参照的记录行</p>
<p>外键列是加到多的那一边的</p>
<h4 id="建立多对多的关联关系"><a href="#建立多对多的关联关系" class="headerlink" title="建立多对多的关联关系"></a>建立多对多的关联关系</h4><p>建立第三张中间表，将两张表链起来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table tb_sc</span><br><span class="line">(</span><br><span class="line">scid int not null auto_increment comment &apos;专门作为主键的自增字段&apos;,</span><br><span class="line">sid int not null comment &apos;学号&apos;,</span><br><span class="line">cid int not null comment &apos;课程编号&apos;,</span><br><span class="line">score float,</span><br><span class="line">primary key (scid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>关系型数据库中也可以使用复合主键，primary key (sid, cid)，或者用sid，cid，和选课时间三个键作为复合主键。但是实际开发中，不会用这样的主键，因为不可重复操作，可能导致麻烦很多，且影响你的表的范式级别。</p>
<h5 id="建立关系"><a href="#建立关系" class="headerlink" title="建立关系"></a>建立关系</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_sc <span class="keyword">add</span> <span class="keyword">constraint</span> fk_sc_sid </span><br><span class="line">foreign <span class="keyword">key</span> (<span class="keyword">sid</span>) <span class="keyword">references</span> tb_student (stuid);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_sc <span class="keyword">add</span> <span class="keyword">constraint</span> fk_sc_cid</span><br><span class="line">foreign <span class="keyword">key</span> (cid) <span class="keyword">REFERENCES</span> tb_course (courseid);</span><br></pre></td></tr></table></figure>
<h5 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_sc (<span class="keyword">sid</span>, cid, score) <span class="keyword">values</span></span><br><span class="line">(<span class="number">1001</span>, <span class="number">001</span>, <span class="number">89</span>),</span><br><span class="line">(<span class="number">1002</span>, <span class="number">003</span>, <span class="number">90</span>),</span><br><span class="line">(<span class="number">1003</span>, <span class="number">001</span>, <span class="number">100</span>),</span><br><span class="line">(<span class="number">1004</span>, <span class="number">004</span>, <span class="number">97</span>),</span><br><span class="line">(<span class="number">1005</span>, <span class="number">002</span>, <span class="number">65</span>),</span><br><span class="line">(<span class="number">1006</span>, <span class="number">001</span>, <span class="number">80</span>);</span><br></pre></td></tr></table></figure>
<p>通过这张中间表，学生和课程的多对多关系就建立起来了。</p>
<h4 id="例子2"><a href="#例子2" class="headerlink" title="例子2"></a>例子2</h4><p>用户订单对应表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table tb_user</span><br><span class="line">(</span><br><span class="line">username varchar(20) not null,</span><br><span class="line">userpass varchar(20) not null,</span><br><span class="line">nickname varchar(50) not null,</span><br><span class="line">email varchar(255),</span><br><span class="line">primary key(username)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>如果关键字作为字段名称，可以加上反引号，就可以建立起来的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_order</span><br><span class="line">(</span><br><span class="line">orderid <span class="built_in">char</span>(<span class="number">12</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">makedata datetime <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">userid <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_order <span class="keyword">add</span> primary <span class="keyword">key</span> (orderid);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_order <span class="keyword">add</span> <span class="keyword">constraint</span> fk_order_userid</span><br><span class="line">foreign <span class="keyword">key</span> (userid) <span class="keyword">references</span> tb_user (username)</span><br><span class="line"><span class="keyword">on</span> <span class="keyword">delete</span> restrict;</span><br></pre></td></tr></table></figure>
<p>级联删除：删除用户时将所属订单全部删除</p>
<p>删除的几种情况：</p>
<p>cascade：级联删除</p>
<p>restrict：默认的情况，不让删除(一般都是这样设置)</p>
<p>set null：当删除用户时，订单中的用户id设置为空(加了非空约束，不成立)</p>
<p>删除基本不会用，只是标志为不可用了</p>
<p>及联更新：</p>
<p>允许修改的键不会设置为主键，可以修改的用户名不会设置为主键。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">on updata cascade # 一般不用</span><br></pre></td></tr></table></figure>
<p>一对多的数据关系：</p>
<p>插入数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">insert into tb_user (username, userpass, nickname) values</span><br><span class="line">(&apos;xiaohua&apos;, &apos;123123&apos;, &apos;huahua&apos;),</span><br><span class="line">(&apos;xiaobai&apos;, &apos;123456&apos;, &apos;abai&apos;);</span><br><span class="line">insert into tb_order values</span><br><span class="line">(&apos;112233445566&apos;, now(), &apos;xiaohua&apos;),</span><br><span class="line">(&apos;112233445567&apos;, now(), &apos;xiaobai&apos;),</span><br><span class="line">(&apos;112233445568&apos;, now(), &apos;xiaohua&apos;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>now()方法是mysql独有的，取到系统时间日期其他数据库没有</p>
</blockquote>
<h4 id="例子3"><a href="#例子3" class="headerlink" title="例子3:"></a>例子3:</h4><p><strong>多对多的读者管理系统</strong></p>
<p>在可视化工具中建立，查看sql预览</p>
<p><strong>建读者表：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_reader</span><br><span class="line">(</span><br><span class="line">readerid <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">rname <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">rtel <span class="built_in">char</span> (<span class="number">11</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">remail <span class="built_in">varchar</span>(<span class="number">255</span>),</span><br><span class="line">primary <span class="keyword">key</span> (readerid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>只有主键能够自增</p>
<p><strong>建书籍表：</strong></p>
<p><img src="/Users/lilamei/blog/hexo/source/_posts/mysql数据库CRUD/可视化建表.png" alt="可视化建表"></p>
<p>同等对应的sql语句为：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_book </span><br><span class="line">(</span><br><span class="line">bookid <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>, </span><br><span class="line">bname <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">bauthor <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">bpublisher <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">bpubdate <span class="built_in">date</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">primary <span class="keyword">key</span> (bookid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><strong>建立外键(举个栗子)</strong></p>
<p><img src="/Users/lilamei/blog/hexo/source/_posts/mysql数据库CRUD/可视化建立外键.png" alt="可视化建立外键"></p>
<p>同等sql语句为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter table tb_book add constraint fk_book_author foreign key (bauthor)  references tb_user(username) </span><br><span class="line">on delete cascade</span><br><span class="line">on update cascade;</span><br></pre></td></tr></table></figure>
<p>sql预览如图所示：</p>
<p><img src="/Users/lilamei/blog/hexo/source/_posts/mysql数据库CRUD/外键预览.png" alt="image-20180827204209018"></p>
<p>外键约束如上</p>
<h5 id="中间表：图书借阅记录表（表示多对多关系）"><a href="#中间表：图书借阅记录表（表示多对多关系）" class="headerlink" title="中间表：图书借阅记录表（表示多对多关系）"></a>中间表：图书借阅记录表（表示多对多关系）</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create table tb_borrow_record</span><br><span class="line">(</span><br><span class="line">recid int not null auto_increment,</span><br><span class="line">rid int not null,</span><br><span class="line">bid int not null,</span><br><span class="line">borrowdate datetime not null,</span><br><span class="line">returndate datetime,</span><br><span class="line">primary key (recid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h5 id="建立外键约束"><a href="#建立外键约束" class="headerlink" title="建立外键约束"></a>建立外键约束</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_borrow_record <span class="keyword">add</span> <span class="keyword">constraint</span> fk_borrow_record_rid foreign <span class="keyword">key</span> (rid) <span class="keyword">references</span> tb_reader (readerid);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_record <span class="keyword">add</span> <span class="keyword">CONSTRAINT</span> fk_record_bid </span><br><span class="line">FOREIGN <span class="keyword">key</span> (bid) <span class="keyword">references</span> tb_book (bookid);</span><br></pre></td></tr></table></figure>
<p>强制性要求还书日期大于借书日期</p>
<h5 id="建立检查约束-保证数据的有效性（域完整性）"><a href="#建立检查约束-保证数据的有效性（域完整性）" class="headerlink" title="建立检查约束:保证数据的有效性（域完整性）"></a>建立检查约束:保证数据的有效性（域完整性）</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table tb_record add constraint ck_record_returndate </span><br><span class="line">check (returndate &gt; borrowdate);</span><br></pre></td></tr></table></figure>
<p>​    写了没有报错，但是没有用。在MySQL中，和SQLite不生效（外键约束也米有用）。但是在oracle和db2和SQLserver等中支持</p>
<p>​    在商业级应用中应该在程序里加这个检查，不是留给数据库检查</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/数据库/" rel="tag"># 数据库</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/08/07/网络爬虫1-http协议和urllib/" rel="next" title="网络爬虫1--http协议和urllib">
                <i class="fa fa-chevron-left"></i> 网络爬虫1--http协议和urllib
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/08/08/网络爬虫2-爬虫初步/" rel="prev" title="网络爬虫2-爬虫初步">
                网络爬虫2-爬虫初步 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">karen2066</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">34</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">karen2066</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>




















  
  
    <script type="text/javascript" src="//jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="//fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="//jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="//velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="//velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="//src/utils.js?v="></script>

  <script type="text/javascript" src="//src/motion.js?v="></script>



  
  

  
  <script type="text/javascript" src="//src/scrollspy.js?v="></script>
<script type="text/javascript" src="//src/post-details.js?v="></script>



  


  <script type="text/javascript" src="//src/bootstrap.js?v="></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
